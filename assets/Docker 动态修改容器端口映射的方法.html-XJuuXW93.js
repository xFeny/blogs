import{_ as a}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as e,c as s,e as n}from"./app-3HwIjC1l.js";const t={},r=n(`<h1 id="docker-动态修改容器端口映射的方法" tabindex="-1"><a class="header-anchor" href="#docker-动态修改容器端口映射的方法" aria-hidden="true">#</a> Docker 动态修改容器端口映射的方法</h1><p>查询容器<code>ip</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># docker inspect mysql | grep &quot;IPAddress&quot;</span>
<span class="token function">docker</span> inspect <span class="token parameter variable">--format</span> <span class="token string">&#39;{{ .NetworkSettings.IPAddress }}&#39;</span> 容器ID/容器名
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Iptables</code>端口映射</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> DOCKER <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token operator">&lt;</span>容器外部端口<span class="token operator">&gt;</span> <span class="token parameter variable">-j</span> DNAT --to-destination <span class="token operator">&lt;</span>容器ip<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>容器内部端口<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>取消端口映射</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-D</span> DOCKER <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-d</span> <span class="token number">0</span>/0 <span class="token parameter variable">--dport</span> <span class="token operator">&lt;</span>容器外部端口<span class="token operator">&gt;</span> <span class="token parameter variable">-j</span> DNAT --to-destination <span class="token operator">&lt;</span>容器ip<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>容器内部端口<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="示例" tabindex="-1"><a class="header-anchor" href="#示例" aria-hidden="true">#</a> 示例</h2><p>如<code>nginx</code>负载均衡<code>nacos</code>集群，要映射<code>8848</code>和<code>9848</code>端口</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> inspect <span class="token parameter variable">--format</span> <span class="token string">&#39;{{ .NetworkSettings.IPAddress }}&#39;</span> nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="http://oss.feny.ink/blogs/images/202401012026973.png" alt="image-20240101202602940" tabindex="0" loading="lazy"><figcaption>image-20240101202602940</figcaption></figure><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> DOCKER <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">8848</span> <span class="token parameter variable">-j</span> DNAT --to-destination <span class="token number">172.17</span>.0.3:8848
iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> DOCKER <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">9848</span> <span class="token parameter variable">-j</span> DNAT --to-destination <span class="token number">172.17</span>.0.3:9848
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,12),p=[r];function o(l,i){return e(),s("div",null,p)}const m=a(t,[["render",o],["__file","Docker 动态修改容器端口映射的方法.html.vue"]]);export{m as default};
